{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2055f9fa-711c-4d61-a003-7f480b2b6cf8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import the required libraries and dependencies\n",
    "import pandas as pd\n",
    "from pathlib import Path\n",
    "import sqlalchemy\n",
    "from datetime import datetime,timezone,tzinfo\n",
    "from sqlalchemy import MetaData, Table, Column, Integer, String"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "bd3fb86b-faa2-493a-a945-07ead4e93a41",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>filename</th>\n",
       "      <th>filetype</th>\n",
       "      <th>filesize</th>\n",
       "      <th>Owner_Name</th>\n",
       "      <th>Public_Key</th>\n",
       "      <th>Asset_name</th>\n",
       "      <th>bid_start_amount</th>\n",
       "      <th>Bid_close_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Laker</td>\n",
       "      <td>Images/image1.png</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/image1.png</td>\n",
       "      <td>0xc852Ab4073FF57c7Fa824D158A3Cdd5CC6707399</td>\n",
       "      <td>Laker_asset</td>\n",
       "      <td>4000.0</td>\n",
       "      <td>6/4/2002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1990</td>\n",
       "      <td>Images/image2.png</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/image2.png</td>\n",
       "      <td>0x408e647764abbAB762fFc730afd3888552660C35</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AllStar</td>\n",
       "      <td>Images/image3.png</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/image3.png</td>\n",
       "      <td>0x949cD3e57F62499ca874F3C59D456F18b9CeBd8F</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Atl0</td>\n",
       "      <td>Images/atl0.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/atl0.jpg</td>\n",
       "      <td>0x23f86eA3f98701A05E8eB6596AAc1F01E3600771</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Atl12</td>\n",
       "      <td>Images/atl12.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/atl12.jpg</td>\n",
       "      <td>0x15784317248d616AFf662f512963e35950743Df4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  filename           filetype  filesize         Owner_Name  \\\n",
       "0    Laker  Images/image1.png    253020  Images/image1.png   \n",
       "1     1990  Images/image2.png    253020  Images/image2.png   \n",
       "2  AllStar  Images/image3.png    253020  Images/image3.png   \n",
       "3     Atl0    Images/atl0.jpg    253020    Images/atl0.jpg   \n",
       "4    Atl12   Images/atl12.jpg    253020   Images/atl12.jpg   \n",
       "\n",
       "                                   Public_Key   Asset_name  bid_start_amount  \\\n",
       "0  0xc852Ab4073FF57c7Fa824D158A3Cdd5CC6707399  Laker_asset            4000.0   \n",
       "1  0x408e647764abbAB762fFc730afd3888552660C35          NaN               NaN   \n",
       "2  0x949cD3e57F62499ca874F3C59D456F18b9CeBd8F          NaN               NaN   \n",
       "3  0x23f86eA3f98701A05E8eB6596AAc1F01E3600771          NaN               NaN   \n",
       "4  0x15784317248d616AFf662f512963e35950743Df4          NaN               NaN   \n",
       "\n",
       "  Bid_close_date  \n",
       "0       6/4/2002  \n",
       "1            NaN  \n",
       "2            NaN  \n",
       "3            NaN  \n",
       "4            NaN  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Using the Pandas read_csv funcion and the Path module, \n",
    "# read \"nft.csv\" file into a Pandas DataFrame\n",
    "\n",
    "nft_df = pd.read_csv(\n",
    "    Path(\"./Resources/nft.csv\")\n",
    ")\n",
    " \n",
    "# Review the DataFrame\n",
    "nft_df.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4a2f2793-1dd6-4232-87fe-c976ad701977",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Engine(sqlite:///)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create the connection string for your SQLite database\n",
    "database_connection_string = 'sqlite:///'\n",
    "\n",
    "# Pass the connection string to the SQLAlchemy create_engine function\n",
    "engine = sqlalchemy.create_engine(database_connection_string, echo=True)\n",
    "\n",
    "# Confirm that the database engine was created.\n",
    "engine"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "789ea6f3-aabf-4bc0-85f8-85b71fffee7b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2022-06-05 07:54:30,483 INFO sqlalchemy.engine.Engine \n",
      "CREATE TABLE nft_info (\n",
      "    \"filename\"             VARCHAR(50),\n",
      "    \"filetype\"             VARCHAR(50),\n",
      "    \"filesize\"             INT,\n",
      "    \"Owner_Name\"           VARCHAR(50),\n",
      "    \"Public_Key\"           VARCHAR(200),\n",
      "    \"Asset_name\"           VARCHAR(50),\n",
      "    \"bid_start_amount\"     INT,\n",
      "    \"Bid_close_date\"       VARCHAR(50)\n",
      "  );\n",
      " \n",
      "2022-06-05 07:54:30,486 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,487 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,488 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' ORDER BY name\n",
      "2022-06-05 07:54:30,489 INFO sqlalchemy.engine.Engine [raw sql] ()\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\locth\\AppData\\Local\\Temp/ipykernel_322272/392259621.py:20: SADeprecationWarning: The Engine.table_names() method is deprecated and will be removed in a future release.  Please refer to Inspector.get_table_names(). (deprecated since: 1.4)\n",
      "  engine.table_names()\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['nft_info']"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Using the nft_info_df DataFrame, create a table called nft_info \n",
    "# inside your newly created database\n",
    "# Be sure include the parameters for the engine, the index, and if_exists with the function\n",
    "create_nft_table = \"\"\"\n",
    "CREATE TABLE nft_info (\n",
    "    \"filename\"             VARCHAR(50),\n",
    "    \"filetype\"             VARCHAR(50),\n",
    "    \"filesize\"             INT,\n",
    "    \"Owner_Name\"           VARCHAR(50),\n",
    "    \"Public_Key\"           VARCHAR(200),\n",
    "    \"Asset_name\"           VARCHAR(50),\n",
    "    \"bid_start_amount\"     INT,\n",
    "    \"Bid_close_date\"       VARCHAR(50)\n",
    "  );\n",
    " \"\"\"\n",
    "\n",
    "engine.execute(create_nft_table)\n",
    "\n",
    "# Confirm that the table was created by calling the table_names function\n",
    "engine.table_names()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ab169052-9599-4838-b93f-4f321f797d6f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2022-06-05 07:54:30,498 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' ORDER BY name\n",
      "2022-06-05 07:54:30,499 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,500 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='view' ORDER BY name\n",
      "2022-06-05 07:54:30,501 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,502 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo(\"nft_info\")\n",
      "2022-06-05 07:54:30,503 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,506 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,507 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,509 INFO sqlalchemy.engine.Engine PRAGMA main.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,509 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,510 INFO sqlalchemy.engine.Engine PRAGMA temp.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,510 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,511 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,511 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,513 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,513 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,514 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,515 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,515 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,516 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,517 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,518 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,518 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,519 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,523 INFO sqlalchemy.engine.Engine SELECT nft_info.filename, nft_info.filetype, nft_info.filesize, nft_info.\"Owner_Name\", nft_info.\"Public_Key\", nft_info.\"Asset_name\", nft_info.bid_start_amount, nft_info.\"Bid_close_date\" \n",
      "FROM nft_info\n",
      "2022-06-05 07:54:30,524 INFO sqlalchemy.engine.Engine [generated in 0.00072s] ()\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>filename</th>\n",
       "      <th>filetype</th>\n",
       "      <th>filesize</th>\n",
       "      <th>Owner_Name</th>\n",
       "      <th>Public_Key</th>\n",
       "      <th>Asset_name</th>\n",
       "      <th>bid_start_amount</th>\n",
       "      <th>Bid_close_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date]\n",
       "Index: []"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create a new DataFrame by reading in the nft_info table from the database\n",
    "sql_nft_info_df = pd.read_sql_table('nft_info', con=engine)\n",
    "\n",
    "# Review the first and last five rows of the DataFrame\n",
    "display(sql_nft_info_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "fa516b90-6305-46c9-b163-83fb9bbed86f",
   "metadata": {},
   "outputs": [],
   "source": [
    "def insert_data(nft_df):\n",
    "          # TO See details\n",
    "##          file_details = {\"filename\":image_file.name, \"filetype\":image_file.type,\n",
    "##                    \"filesize\":image_file.size,\"Owner Name\":username,'Public Key':public_key,'Asset Name':asset_caption,'bid start amount':bid_start,\"Bid close date\":close_date_request.isoformat()}\n",
    "    \n",
    "##    insert_data = f\"\"\"\n",
    "##    INSERT INTO nft_info\n",
    "##    VALUES ('{names}', {amount}, {date}, '{image}')\n",
    "##    \"\"\"\n",
    "    \n",
    "##    print(insert_data)\n",
    "##    engine.execute(insert_data)\n",
    "    for index, row in nft_df.iterrows():\n",
    "         engine.execute(\"INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\", row.filename, row.filetype, row.filesize,row.Owner_Name, row.Public_Key, row.Asset_name, row.bid_start_amount, row.Bid_close_date)\n",
    "    \n",
    "    sql_nft_info_df = pd.read_sql_table('nft_info', con=engine)\n",
    "    \n",
    "    display(sql_nft_info_df.tail())\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "086ab524-440a-4fff-b87e-b7869f6a6cc9",
   "metadata": {},
   "outputs": [],
   "source": [
    "def select_data():\n",
    "##    query_info=f\"\"\"\n",
    "##    SELECT '{select_what}'\n",
    "##    FROM '{from_table}'\n",
    "##    WHERE '{where_condition}'\n",
    "##    \"\"\"\n",
    "    \n",
    "    sql_nft_info_df = pd.read_sql_table('nft_info', con=engine)\n",
    "    display(sql_nft_info_df.tail())\n",
    "##    results = engine.execute(query_info)\n",
    "    \n",
    "##    list(results)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "422ad7aa-eb26-4b20-a5de-ea80eafc787b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def update_data(Public_Key):\n",
    "    update_data = \"\"\"\n",
    "    UPDATE nft_info\n",
    "    SET 'filename' = '{nft_df.filename}',\n",
    "        'filetype' = '{nft_df.filetype}',\n",
    "        'filesize' = '{nft_df.filesize}',\n",
    "        'Owner_Name' = '{nft_df.Owner_Name}',\n",
    "        'Asset_name' = '{nft_df.Asset_name}',\n",
    "        'bid_start_amount' = '{nft_df.bid_start_amount}',\n",
    "        'Bid_close_date' = '{nft_df.Bid_close_date}'\n",
    "    WHERE 'Public_Key' = '{nft_df.Public_Key}'\n",
    "    \"\"\"\n",
    "##    for index, row in nft_df.iterrows():\n",
    "##         engine.execute(\"UPDATE nft_info SET (filename = 'row.filename' , filetype = ?, filesize = ?, Owner_Name = ?, Asset_name = ?, bid_start_amount = ?, Bid_close_date = ?) WHERE Public_Key = ?\", , row.filetype, row.filesize,row.Owner_Name, row.Asset_name, row.bid_start_amount, row.Bid_close_date, row.Public_Key)\n",
    "    \n",
    "    \n",
    "    # Execute the update in the database\n",
    "##    engine.execute(update_data)\n",
    "##    sql_nft_info_df = pd.read_sql_table('nft_info', con=engine)\n",
    "    \n",
    "##    display(sql_nft_info_df.tail())    \n",
    "    engine.execute(update_data)\n",
    "    read_all_data = \"\"\"\n",
    "    SELECT * FROM nft_info\n",
    "    \"\"\"\n",
    "    results = engine.execute(read_all_data)\n",
    "    sql_nft_info_df = pd.read_sql_table('nft_info', con=engine)\n",
    "    display(sql_nft_info_df.tail())    \n",
    "    list(results)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9b34df74-0721-4d65-b6ed-74850e5a2e05",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2022-06-05 07:54:30,593 INFO sqlalchemy.engine.Engine \n",
      "    UPDATE nft_info\n",
      "    SET 'filename' = '{nft_df.filename}',\n",
      "        'filetype' = '{nft_df.filetype}',\n",
      "        'filesize' = '{nft_df.filesize}',\n",
      "        'Owner_Name' = '{nft_df.Owner_Name}',\n",
      "        'Asset_name' = '{nft_df.Asset_name}',\n",
      "        'bid_start_amount' = '{nft_df.bid_start_amount}',\n",
      "        'Bid_close_date' = '{nft_df.Bid_close_date}'\n",
      "    WHERE 'Public_Key' = '{nft_df.Public_Key}'\n",
      "    \n",
      "2022-06-05 07:54:30,594 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,595 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,596 INFO sqlalchemy.engine.Engine \n",
      "    SELECT * FROM nft_info\n",
      "    \n",
      "2022-06-05 07:54:30,596 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,597 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' ORDER BY name\n",
      "2022-06-05 07:54:30,598 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,598 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='view' ORDER BY name\n",
      "2022-06-05 07:54:30,598 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,599 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo(\"nft_info\")\n",
      "2022-06-05 07:54:30,600 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,601 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,601 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,602 INFO sqlalchemy.engine.Engine PRAGMA main.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,603 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,603 INFO sqlalchemy.engine.Engine PRAGMA temp.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,604 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,604 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,605 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,606 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,606 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,607 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,607 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,608 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,608 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,609 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,610 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,611 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,612 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,613 INFO sqlalchemy.engine.Engine SELECT nft_info.filename, nft_info.filetype, nft_info.filesize, nft_info.\"Owner_Name\", nft_info.\"Public_Key\", nft_info.\"Asset_name\", nft_info.bid_start_amount, nft_info.\"Bid_close_date\" \n",
      "FROM nft_info\n",
      "2022-06-05 07:54:30,614 INFO sqlalchemy.engine.Engine [generated in 0.00050s] ()\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>filename</th>\n",
       "      <th>filetype</th>\n",
       "      <th>filesize</th>\n",
       "      <th>Owner_Name</th>\n",
       "      <th>Public_Key</th>\n",
       "      <th>Asset_name</th>\n",
       "      <th>bid_start_amount</th>\n",
       "      <th>Bid_close_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date]\n",
       "Index: []"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "update_data(0x8BDaE51c43C32402618D7eFC841c2486fbeEBf59)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "02310943-35a8-4d87-9cff-72e8a7d675d2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2022-06-05 07:54:30,626 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,627 INFO sqlalchemy.engine.Engine [raw sql] ('Laker', 'Images/image1.png', 253020, 'Images/image1.png', '0xc852Ab4073FF57c7Fa824D158A3Cdd5CC6707399', 'Laker_asset', 4000.0, '6/4/2002')\n",
      "2022-06-05 07:54:30,627 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,629 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,629 INFO sqlalchemy.engine.Engine [raw sql] ('1990', 'Images/image2.png', 253020, 'Images/image2.png', '0x408e647764abbAB762fFc730afd3888552660C35', nan, nan, nan)\n",
      "2022-06-05 07:54:30,630 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,631 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,631 INFO sqlalchemy.engine.Engine [raw sql] ('AllStar', 'Images/image3.png', 253020, 'Images/image3.png', '0x949cD3e57F62499ca874F3C59D456F18b9CeBd8F', nan, nan, nan)\n",
      "2022-06-05 07:54:30,632 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,633 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,633 INFO sqlalchemy.engine.Engine [raw sql] ('Atl0', 'Images/atl0.jpg', 253020, 'Images/atl0.jpg', '0x23f86eA3f98701A05E8eB6596AAc1F01E3600771', nan, nan, nan)\n",
      "2022-06-05 07:54:30,634 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,634 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,635 INFO sqlalchemy.engine.Engine [raw sql] ('Atl12', 'Images/atl12.jpg', 253020, 'Images/atl12.jpg', '0x15784317248d616AFf662f512963e35950743Df4', nan, nan, nan)\n",
      "2022-06-05 07:54:30,636 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,636 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,637 INFO sqlalchemy.engine.Engine [raw sql] ('Atl17', 'Images/atl17.jpg', 253020, 'Images/atl17.jpg', '0x10e1072f12Abd7Db152aF026D56fA6692B0B24EC', nan, nan, nan)\n",
      "2022-06-05 07:54:30,638 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,639 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,639 INFO sqlalchemy.engine.Engine [raw sql] ('Atl7', 'Images/atl7.jpg', 253020, 'Images/atl7.jpg', '0x5a50Fe1A38D5b0C10Cea72C4BB857193e5595DDa', nan, nan, nan)\n",
      "2022-06-05 07:54:30,640 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,641 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,641 INFO sqlalchemy.engine.Engine [raw sql] ('Bulls21', 'Images/bulls21.jpg', 253020, 'Images/bulls21.jpg', '0x8FfdB71Ec8F0925ED9Bc029Eb4072dd369104074', nan, nan, nan)\n",
      "2022-06-05 07:54:30,642 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,643 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,643 INFO sqlalchemy.engine.Engine [raw sql] ('Chi10', 'Images/bulls5.jpg', 253020, 'Images/bulls5.jpg', '0x8BDaE51c43C32402618D7eFC841c2486fbeEBf59', 'Bulls10', 7000.0, '4/3/2020')\n",
      "2022-06-05 07:54:30,644 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,645 INFO sqlalchemy.engine.Engine INSERT INTO nft_info(filename, filetype, filesize, Owner_Name, Public_Key, Asset_name, bid_start_amount, Bid_close_date) values(?,?,?,?,?,?,?,?)\n",
      "2022-06-05 07:54:30,645 INFO sqlalchemy.engine.Engine [raw sql] ('Bulls7', 'Images/chi7.jpg', 253020, 'Images/chi7.jpg', '0x031E8c27e6Bf3ea5d32552A3D29c1C4FD6d46A0f', 'Chi7', 5000.0, '5/2/2022')\n",
      "2022-06-05 07:54:30,646 INFO sqlalchemy.engine.Engine COMMIT\n",
      "2022-06-05 07:54:30,646 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='table' ORDER BY name\n",
      "2022-06-05 07:54:30,647 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,648 INFO sqlalchemy.engine.Engine SELECT name FROM sqlite_master WHERE type='view' ORDER BY name\n",
      "2022-06-05 07:54:30,648 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,650 INFO sqlalchemy.engine.Engine PRAGMA main.table_xinfo(\"nft_info\")\n",
      "2022-06-05 07:54:30,650 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,651 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,652 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,653 INFO sqlalchemy.engine.Engine PRAGMA main.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,653 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,653 INFO sqlalchemy.engine.Engine PRAGMA temp.foreign_key_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,654 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,655 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,655 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,656 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,657 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,657 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,658 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,658 INFO sqlalchemy.engine.Engine PRAGMA main.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,659 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,659 INFO sqlalchemy.engine.Engine PRAGMA temp.index_list(\"nft_info\")\n",
      "2022-06-05 07:54:30,660 INFO sqlalchemy.engine.Engine [raw sql] ()\n",
      "2022-06-05 07:54:30,660 INFO sqlalchemy.engine.Engine SELECT sql FROM  (SELECT * FROM sqlite_master UNION ALL   SELECT * FROM sqlite_temp_master) WHERE name = ? AND type = 'table'\n",
      "2022-06-05 07:54:30,661 INFO sqlalchemy.engine.Engine [raw sql] ('nft_info',)\n",
      "2022-06-05 07:54:30,662 INFO sqlalchemy.engine.Engine SELECT nft_info.filename, nft_info.filetype, nft_info.filesize, nft_info.\"Owner_Name\", nft_info.\"Public_Key\", nft_info.\"Asset_name\", nft_info.bid_start_amount, nft_info.\"Bid_close_date\" \n",
      "FROM nft_info\n",
      "2022-06-05 07:54:30,663 INFO sqlalchemy.engine.Engine [generated in 0.00057s] ()\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>filename</th>\n",
       "      <th>filetype</th>\n",
       "      <th>filesize</th>\n",
       "      <th>Owner_Name</th>\n",
       "      <th>Public_Key</th>\n",
       "      <th>Asset_name</th>\n",
       "      <th>bid_start_amount</th>\n",
       "      <th>Bid_close_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Atl17</td>\n",
       "      <td>Images/atl17.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/atl17.jpg</td>\n",
       "      <td>0x10e1072f12Abd7Db152aF026D56fA6692B0B24EC</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Atl7</td>\n",
       "      <td>Images/atl7.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/atl7.jpg</td>\n",
       "      <td>0x5a50Fe1A38D5b0C10Cea72C4BB857193e5595DDa</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Bulls21</td>\n",
       "      <td>Images/bulls21.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/bulls21.jpg</td>\n",
       "      <td>0x8FfdB71Ec8F0925ED9Bc029Eb4072dd369104074</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Chi10</td>\n",
       "      <td>Images/bulls5.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/bulls5.jpg</td>\n",
       "      <td>0x8BDaE51c43C32402618D7eFC841c2486fbeEBf59</td>\n",
       "      <td>Bulls10</td>\n",
       "      <td>7000.0</td>\n",
       "      <td>4/3/2020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Bulls7</td>\n",
       "      <td>Images/chi7.jpg</td>\n",
       "      <td>253020</td>\n",
       "      <td>Images/chi7.jpg</td>\n",
       "      <td>0x031E8c27e6Bf3ea5d32552A3D29c1C4FD6d46A0f</td>\n",
       "      <td>Chi7</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>5/2/2022</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  filename            filetype  filesize          Owner_Name  \\\n",
       "5    Atl17    Images/atl17.jpg    253020    Images/atl17.jpg   \n",
       "6     Atl7     Images/atl7.jpg    253020     Images/atl7.jpg   \n",
       "7  Bulls21  Images/bulls21.jpg    253020  Images/bulls21.jpg   \n",
       "8    Chi10   Images/bulls5.jpg    253020   Images/bulls5.jpg   \n",
       "9   Bulls7     Images/chi7.jpg    253020     Images/chi7.jpg   \n",
       "\n",
       "                                   Public_Key Asset_name  bid_start_amount  \\\n",
       "5  0x10e1072f12Abd7Db152aF026D56fA6692B0B24EC       None               NaN   \n",
       "6  0x5a50Fe1A38D5b0C10Cea72C4BB857193e5595DDa       None               NaN   \n",
       "7  0x8FfdB71Ec8F0925ED9Bc029Eb4072dd369104074       None               NaN   \n",
       "8  0x8BDaE51c43C32402618D7eFC841c2486fbeEBf59    Bulls10            7000.0   \n",
       "9  0x031E8c27e6Bf3ea5d32552A3D29c1C4FD6d46A0f       Chi7            5000.0   \n",
       "\n",
       "  Bid_close_date  \n",
       "5           None  \n",
       "6           None  \n",
       "7           None  \n",
       "8       4/3/2020  \n",
       "9       5/2/2022  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "insert_data(nft_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "37d506a4-876b-477d-92dc-03a1755100d7",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
